<!doctype html>
<html lang="zh">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <title>文本生成</title>
    <link href="assets/images/logos/favicon.png" rel="shortcut icon" type="image/png"/>
    <link href="assets/css/styles.min.css" rel="stylesheet"/>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        h1, h2 {
            color: #5D87FF;
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        input[type="text"],
        input[type="number"],
        select,
        textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
            margin-bottom: 10px;
            font-size: 16px;
        }

        button {
            background-color: #5D87FF;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #4f73d9;
        }

        #textGenOutput {
            text-align: center;
            margin-top: 10px;
        }

        /* Loading Animation */
        .loading {
            display: none;
            text-align: center;
            margin-top: 20px;
        }

        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #5D87FF;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 2s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
                margin: 10px auto;
            }

            input[type="text"],
            input[type="number"],
            select,
            textarea {
                font-size: 14px;
            }

            button {
                font-size: 14px;
            }
        }
    </style>
</head>

<body>
<!-- 页面包裹 -->
<div class="page-wrapper" data-header-position="fixed" data-layout="vertical" data-navbarbg="skin6" data-sidebar-position="fixed"
     data-sidebartype="full" id="main-wrapper">


    <!-- 侧边栏开始 -->
    <aside class="left-sidebar">
        <div>
            <div class="brand-logo d-flex align-items-center justify-content-between">
                <a class="text-nowrap logo-img" href="./index.html">
                    <img alt="" src="assets/images/logos/dark-logo.svg" width="180"/>
                </a>
                <div class="close-btn d-xl-none d-block sidebartoggler cursor-pointer" id="sidebarCollapse">
                    <i class="ti ti-x fs-8"></i>
                </div>
            </div>
            <nav class="sidebar-nav scroll-sidebar" data-simplebar="">
                <ul id="sidebarnav">
                    <li class="nav-small-cap">
                        <i class="ti ti-home nav-small-cap-icon fs-4"></i>
                        <span class="hide-menu">首页</span>
                    </li>
                    <li class="sidebar-item">
                        <a aria-expanded="false" class="sidebar-link" href="./index.html">
                            <span>
                              <i class="ti ti-dashboard"></i>
                            </span>
                            <span class="hide-menu">仪表盘</span>
                        </a>
                    </li>
                    <li class="nav-small-cap">
                        <i class="ti ti-brain nav-small-cap-icon fs-4"></i>
                        <span class="hide-menu">AI 生成</span>
                    </li>
                    <li class="sidebar-item">
                        <a aria-expanded="false" class="sidebar-link" href="./text-generation.html">
                            <span>
                              <i class="ti ti-text-size"></i>
                            </span>
                            <span class="hide-menu">文本生成</span>
                        </a>
                    </li>
                    <li class="sidebar-item">
                        <a aria-expanded="false" class="sidebar-link" href="./image-generation.html">
                            <span>
                              <i class="ti ti-photo"></i>
                            </span>
                            <span class="hide-menu">图像生成</span>
                        </a>
                    </li>
                    <li class="nav-small-cap">
                        <i class="ti ti-brain nav-small-cap-icon fs-4"></i>
                        <span class="hide-menu">AI 转换</span>
                    </li>
                    <li class="sidebar-item">
                        <a aria-expanded="false" class="sidebar-link" href="./text-to-video.html">
                            <span>
                              <i class="ti ti-video"></i>
                            </span>
                            <span class="hide-menu">文本转视频</span>
                        </a>
                    </li>
                    <li class="sidebar-item">
                        <a aria-expanded="false" class="sidebar-link" href="./image-to-video.html">
                            <span>
                              <i class="ti ti-file"></i>
                            </span>
                            <span class="hide-menu">图像转视频</span>
                        </a>
                    </li>
                    <li class="nav-small-cap">
                        <i class="ti ti-brain nav-small-cap-icon fs-4"></i>
                        <span class="hide-menu">AI 数字人</span>
                    </li>
                    <li class="sidebar-item">
                        <a aria-expanded="false" class="sidebar-link" href="./voice-clone.html">
                            <span>
                              <i class="ti ti-microphone"></i>
                            </span>
                            <span class="hide-menu">声音复刻</span>
                        </a>
                    </li>
                    <li class="sidebar-item">
                        <a aria-expanded="false" class="sidebar-link" href="./voice-generation.html">
                            <span>
                              <i class="ti ti-speakerphone"></i>
                            </span>
                            <span class="hide-menu">语音生成</span>
                        </a>
                    </li>
                    <li class="nav-small-cap">
                        <i class="ti ti-brain nav-small-cap-icon fs-4"></i>
                        <span class="hide-menu">通用</span>
                    </li>
                    <li class="sidebar-item">
                        <a aria-expanded="false" class="sidebar-link" href="./history.html">
                            <span>
                              <i class="ti ti-history"></i>
                            </span>
                            <span class="hide-menu">任务历史</span>
                        </a>
                    </li>
                    <li class="nav-small-cap">
                        <i class="ti ti-lock nav-small-cap-icon fs-4"></i>
                        <span class="hide-menu">认证</span>
                    </li>
                    <li class="sidebar-item">
                        <a aria-expanded="false" class="sidebar-link" href="./authentication.html" onclick="logout()">
                            <span>
                                <i class="ti ti-login"></i>
                            </span>
                            <span class="hide-menu">登出秘钥</span>
                        </a>
                    </li>
                    <li class="sidebar-item">
                        <a aria-expanded="false" class="sidebar-link" href="./authentication.html">
                            <span>
                              <i class="ti ti-key"></i>
                            </span>
                            <span class="hide-menu">切换秘钥</span>
                        </a>
                    </li>
                    <li class="nav-small-cap">
                        <i class="ti ti-settings nav-small-cap-icon fs-4"></i>
                        <span class="hide-menu">额外</span>
                    </li>
                    <li class="sidebar-item">
                        <a aria-expanded="false" class="sidebar-link" href="./icon-tabler.html">
                            <span>
                              <i class="ti ti-icons"></i>
                            </span>
                            <span class="hide-menu">图标</span>
                        </a>
                    </li>
                    <li class="sidebar-item">
                        <a aria-expanded="false" class="sidebar-link" href="./sample-page.html">
                            <span>
                              <i class="ti ti-file-code"></i>
                            </span>
                            <span class="hide-menu">示例页面</span>
                        </a>
                    </li>
                </ul>
                <div class="unlimited-access hide-menu bg-light-primary position-relative mb-7 mt-5 rounded">
                    <div class="d-flex">
                        <div class="unlimited-access-title me-3">
                            <h6 class="fw-semibold fs-4 mb-6 text-dark w-85">升级到专业版</h6>
                            <a class="btn btn-primary fs-2 fw-semibold lh-sm" href="#">购买专业版</a>
                        </div>
                        <div class="unlimited-access-img">
                            <img alt="" class="img-fluid" src="assets/images/backgrounds/rocket.png">
                        </div>
                    </div>
                </div>
            </nav>
        </div>
    </aside>
    <!-- 侧边栏结束 -->

    <!-- 主内容包裹 -->
    <div class="body-wrapper">
        <!-- 头部开始 -->
        <header class="app-header">
            <nav class="navbar navbar-expand-lg navbar-light">
                <ul class="navbar-nav">
                    <li class="nav-item d-block d-xl-none">
                        <a class="nav-link sidebartoggler nav-icon-hover" href="javascript:void(0)" id="headerCollapse">
                            <i class="ti ti-menu-2"></i>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link nav-icon-hover" href="javascript:void(0)">
                            <i class="ti ti-bell-ringing"></i>
                            <div class="notification bg-primary rounded-circle"></div>
                        </a>
                    </li>
                </ul>
                <div class="navbar-collapse justify-content-end px-0" id="navbarNav">
                    <ul class="navbar-nav flex-row ms-auto align-items-center justify-content-end">
                        <a class="btn btn-primary" href="#">免费下载</a>
                        <li class="nav-item dropdown">
                            <a aria-expanded="false" class="nav-link nav-icon-hover" data-bs-toggle="dropdown"
                               href="javascript:void(0)"
                               id="drop2">
                                <img alt="" class="rounded-circle" height="35" src="assets/images/profile/user-1.jpg"
                                     width="35">
                            </a>
                            <div aria-labelledby="drop2"
                                 class="dropdown-menu dropdown-menu-end dropdown-menu-animate-up">
                                <div class="message-body">
                                    <a class="d-flex align-items-center gap-2 dropdown-item" href="javascript:void(0)">
                                        <i class="ti ti-user fs-6"></i>
                                        <p class="mb-0 fs-3">我的个人资料</p>
                                    </a>
                                    <a class="d-flex align-items-center gap-2 dropdown-item" href="javascript:void(0)">
                                        <i class="ti ti-mail fs-6"></i>
                                        <p class="mb-0 fs-3">我的账户</p>
                                    </a>
                                    <a class="d-flex align-items-center gap-2 dropdown-item" href="javascript:void(0)">
                                        <i class="ti ti-list-check fs-6"></i>
                                        <p class="mb-0 fs-3">我的任务</p>
                                    </a>
                                    <a class="btn btn-outline-primary mx-3 mt-2 d-block"
                                       href="./authentication.html">登出</a>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </nav>
        </header>
        <!-- 头部结束 -->

        <div class="container-fluid">
            <div class="card">
                <div class="card-body">
                    <!-- 文本生成部分 -->
                    <div class="tab-content active" id="textGen">
                        <h5 class="card-title fw-semibold mb-4" style="color: #007bff;">文本生成</h5>

                        <div class="form-group">
                            <label for="textGenModel">选择模型：</label>
                            <select id="textGenModel">
                                <option value="mistralai/mistral-small-3.1-24b-instruct:free">
                                    mistralai/mistral-small-3.1-24b-instruct:free
                                </option>
                                <option value="open-r1/olympiccoder-7b:free">open-r1/olympiccoder-7b:free</option>
                                <option value="open-r1/olympiccoder-32b:free">open-r1/olympiccoder-32b:free</option>
                                <!-- 其他模型选项略 -->
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="textGenInput">输入生成要求：</label>
                            <textarea cols="50" id="textGenInput" rows="4"></textarea>
                        </div>

                        <button onclick="generateText()">生成文本</button>
                        <div id="textGenOutput">生成的文本将显示在这里...</div>
                    </div>
                    <!-- 文本生成部分结束 -->

                    <!-- 其他页面内容 -->
                    <!-- 可选的图片/视频生成部分等 -->
                    <!-- 页面内容略 -->

                </div>
            </div>
        </div>
    </div>
</div>

<!-- 加载提示层 -->
<div class="overlay" id="overlay" style="display: none;">
    <div class="loader"></div>
</div>

<script src="assets/libs/jquery/dist/jquery.min.js"></script>
<script src="assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="assets/js/sidebarmenu.js"></script>
<script src="assets/js/app.min.js"></script>
<script src="assets/libs/apexcharts/dist/apexcharts.min.js"></script>
<script src="assets/libs/simplebar/dist/simplebar.js"></script>
<script src="assets/js/dashboard.js"></script>

<script>
    const API_ENDPOINT = 'https://youn1ipym2oaxxiasnow.deepln.com/suansuan'; // 替换为您的 API 端点
    let apiKey = localStorage.getItem('apiKey') || '';

    // 发出 API 请求的函数
    async function apiRequest(endpoint, method, data = null, isFormData = false) {
        const headers = {
            'suan-key-token': apiKey,
        };
        let body;
        if (isFormData) {
            body = data;
        } else if (data) {
            headers['Content-Type'] = 'application/json';
            body = JSON.stringify(data);
        }

        const overlay = document.getElementById('overlay');
        overlay.style.display = 'flex'; // 显示加载中提示

        try {
            const response = await fetch(API_ENDPOINT + endpoint, {
                method,
                headers,
                body,
            });

            if (!response.ok) {
                throw new Error(`HTTP 错误！状态：${response.status}`);
            }

            return await response.json();
        } catch (error) {
            console.error('API 请求失败：', error);
            alert('API 请求失败：' + error.message);
            // 点击确定后跳转到错误页面，比如 error.html
            window.location.href = 'authentication.html';
            throw error;
        } finally {
            overlay.style.display = 'none'; // 隐藏加载中提示
        }
    }

    // 文本生成函数
    async function generateText() {
        const userInput = document.getElementById('textGenInput').value;
        const model = document.getElementById('textGenModel').value;

        const formData = new FormData();
        formData.append('user_input', userInput);
        formData.append('model', model);

        try {
            const response = await apiRequest('/generate_text', 'POST', formData, true);
            document.getElementById('textGenOutput').innerText = '生成的文本：' + response.text;
        } catch (error) {
            console.error('生成文本出错：', error);
        }
    }

    // 页面初始化
    loadModels();

    // 加载文本生成模型列表
    async function loadModels() {
        try {
            const models = await apiRequest('/models', 'POST');
            const modelSelect = document.getElementById('textGenModel');
            modelSelect.innerHTML = ''; // 清空现有选项
            models.forEach(model => {
                const option = document.createElement('option');
                option.value = model;
                option.text = model;
                modelSelect.add(option);
            });
        } catch (error) {
            console.error('加载模型出错：', error);
        }
    }

    // 验证
    function logout() {
        apiKey = 'isLogout';
        localStorage.setItem('apiKey', apiKey);
    }
</script>
</body>
</html>
